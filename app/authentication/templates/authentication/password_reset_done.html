{% extends 'authentication/base.html' %}

{% block title %}Reset Link Sent - Bank Statement Analyzer{% endblock %}

{% block header_title %}Check Your Email{% endblock %}
{% block header_subtitle %}We've sent you a password reset link{% endblock %}

{% block content %}
<div class="text-center">
    <div class="mb-4">
        <div class="success-icon mb-3">
            <i class="fas fa-envelope-open-text fa-4x text-success"></i>
        </div>
        
        <div class="alert alert-success">
            <h5 class="alert-heading">
                <i class="fas fa-check-circle me-2"></i>Reset Link Sent!
            </h5>
            <p class="mb-0">
                We've sent a password reset link to your email address. 
                Click the link in the email to create a new password.
            </p>
        </div>
    </div>
    
    <div class="mb-4">
        <div class="card border-0 bg-light">
            <div class="card-body">
                <h6 class="card-title">
                    <i class="fas fa-info-circle me-2 text-info"></i>What's Next?
                </h6>
                <ul class="list-unstyled mb-0 text-start">
                    <li class="mb-2">
                        <i class="fas fa-envelope me-2 text-primary"></i>
                        Check your email inbox (and spam folder)
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-mouse-pointer me-2 text-primary"></i>
                        Click the reset link in the email
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-key me-2 text-primary"></i>
                        Create a new secure password
                    </li>
                    <li>
                        <i class="fas fa-sign-in-alt me-2 text-primary"></i>
                        Sign in with your new password
                    </li>
                </ul>
            </div>
        </div>
    </div>
    
    <div class="mb-3">
        <small class="text-muted">
            <i class="fas fa-clock me-1"></i>
            The reset link will expire in <strong>1 hour</strong> for security reasons.
        </small>
    </div>
    
    <div class="d-grid gap-2 col-md-6 mx-auto">
        <a href="{% url 'authentication:login' %}" class="btn btn-primary">
            <i class="fas fa-arrow-left me-2"></i>Back to Sign In
        </a>
    </div>
    
    <div class="mt-4">
        <p class="text-muted mb-2">Didn't receive the email?</p>
        <div class="d-flex justify-content-center gap-2 flex-wrap">
            <a href="{% url 'authentication:password_reset' %}" class="btn btn-outline-secondary btn-sm">
                <i class="fas fa-redo me-1"></i>Resend Link
            </a>
            <button type="button" class="btn btn-outline-info btn-sm" data-bs-toggle="modal" data-bs-target="#helpModal">
                <i class="fas fa-question-circle me-1"></i>Need Help?
            </button>
        </div>
    </div>
</div>

<!-- Help Modal -->
<div class="modal fade" id="helpModal" tabindex="-1" aria-labelledby="helpModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="helpModalLabel">
                    <i class="fas fa-question-circle me-2"></i>Troubleshooting
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h6><i class="fas fa-search me-2"></i>Can't find the email?</h6>
                <ul class="mb-3">
                    <li>Check your spam/junk folder</li>
                    <li>Make sure you entered the correct email address</li>
                    <li>Wait a few minutes - emails can sometimes be delayed</li>
                </ul>
                
                <h6><i class="fas fa-exclamation-triangle me-2"></i>Still having issues?</h6>
                <ul class="mb-0">
                    <li>Try requesting a new reset link</li>
                    <li>Contact support if the problem persists</li>
                    <li>Make sure your email provider isn't blocking our emails</li>
                </ul>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <a href="{% url 'authentication:password_reset' %}" class="btn btn-primary">
                    <i class="fas fa-redo me-1"></i>Try Again
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block auth_links %}
<div class="auth-links">
    <p class="mb-2">Remember your password?</p>
    <a href="{% url 'authentication:login' %}" class="btn btn-outline-secondary">
        <i class="fas fa-sign-in-alt me-2"></i>Sign In
    </a>
</div>
{% endblock %}

{% block extra_js %}
<script>
    $(document).ready(function() {
        // Auto-refresh page after 5 minutes to encourage checking email
        setTimeout(function() {
            if (confirm('It\'s been a few minutes. Would you like to refresh the page to check if you\'ve received the email?')) {
                location.reload();
            }
        }, 300000); // 5 minutes
        
        // Track if user clicks resend link
        $('a[href*="password_reset"]').on('click', function() {
            // Add a small delay to show user feedback
            $(this).html('<i class="fas fa-spinner fa-spin me-1"></i>Sending...');
        });
    });
</script>
{% endblock %}